version: 1
disable_existing_loggers: false

formatters:
  default:
    format: "<green>{time:YYYY-MM-DD HH:mm:ss}</green> | <level>{level: <8}</level> | <cyan>{name}</cyan>:<cyan>{function}</cyan>:<cyan>{line}</cyan> - <level>{message}</level>"
  
  simple:
    format: "{time:YYYY-MM-DD HH:mm:ss} | {level} | {message}"
  
  detailed:
    format: "{time:YYYY-MM-DD HH:mm:ss.SSS} | {level: <8} | {name}:{function}:{line} | {message}"

handlers:
  console:
    sink: "sys.stdout"
    level: "INFO"
    format: "<green>{time:YYYY-MM-DD HH:mm:ss}</green> | <level>{level: <8}</level> | <cyan>{name}</cyan>:<cyan>{function}</cyan>:<cyan>{line}</cyan> - <level>{message}</level>"
    colorize: true
  
  file_info:
    sink: "logs/info_{time:YYYY-MM-DD}.log"
    level: "INFO"
    rotation: "00:00"  # 每天午夜轮转
    retention: "30 days"  # 保留 30 天
    compression: "zip"  # 压缩旧日志
    encoding: "utf-8"
    format: "{time:YYYY-MM-DD HH:mm:ss.SSS} | {level: <8} | {name}:{function}:{line} | {message}"
  
  file_error:
    sink: "logs/error_{time:YYYY-MM-DD}.log"
    level: "ERROR"
    rotation: "00:00"
    retention: "90 days"  # 错误日志保留更长时间
    compression: "zip"
    encoding: "utf-8"
    format: "{time:YYYY-MM-DD HH:mm:ss.SSS} | {level: <8} | {name}:{function}:{line} | {message}\n{exception}"
  
  file_debug:
    sink: "logs/debug_{time:YYYY-MM-DD}.log"
    level: "DEBUG"
    rotation: "100 MB"  # 按大小轮转
    retention: "7 days"
    compression: "zip"
    encoding: "utf-8"
    format: "{time:YYYY-MM-DD HH:mm:ss.SSS} | {level: <8} | {name}:{function}:{line} | {message}"

loggers:
  uvicorn:
    level: "INFO"
  
  sqlalchemy:
    level: "WARNING"
  
  backend:
    level: "DEBUG"
